{"version":3,"sources":["../src/utils.js"],"names":["camelCase","snakeCase","getConfig","modifyObjectKeys","object","modify","undefined","Array","isArray","map","value","result","Object","entries","forEach","key","camelCaseObject","snakeCaseObject","convertKeyNames","nameMap","transformer","getQueryParameters","search","global","location","keyValueFragments","slice","indexOf","split","filter","hash","reduce","params","keyValueFragment","assign","decodeURIComponent","ensureDefinedConfig","requester","keys","console","warn","generateAPIConfigUrl","APP_ID","MFE_CONFIG_API_PATH","MFE_CONFIG_API_PORT","MFE_CONFIG_API_REGEX","regex","RegExp","host","window","hostname","match","join","URLSearchParams","append","queryParams","toString","url","URL","protocol","port"],"mappings":"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","sourcesContent":["/**\n * #### Import members from **@edx/frontend-platform**\n *\n * @module Utilities\n */\nimport camelCase from 'lodash.camelcase';\nimport snakeCase from 'lodash.snakecase';\nimport { getConfig } from './config';\n\n/**\n * This is the underlying function used by camelCaseObject, snakeCaseObject, and convertKeyNames\n * above.\n *\n * Given an object (or array) and a modification function, will perform the function on each key it\n * encounters on the object and its tree of children.\n *\n * The modification function must take a string as an argument and returns a string.\n *\n * Example:\n *\n * ```\n * (key) => {\n *   if (key === 'edX') {\n *     return 'Open edX';\n *   }\n *   return key;\n * }\n * ```\n *\n * This function will turn any key that matches 'edX' into 'Open edX'.  All other keys will be\n * passed through unmodified.\n *\n * Can accept arrays as well as objects, and will perform its conversion on any objects it finds in\n * the array.\n *\n * @param {Object} object\n * @param {function} modify\n * @returns {Object}\n */\nexport function modifyObjectKeys(object, modify) {\n  // If the passed in object is not an Object, return it.\n  if (\n    object === undefined\n    || object === null\n    || (typeof object !== 'object' && !Array.isArray(object))\n  ) {\n    return object;\n  }\n\n  if (Array.isArray(object)) {\n    return object.map(value => modifyObjectKeys(value, modify));\n  }\n\n  // Otherwise, process all its keys.\n  const result = {};\n  Object.entries(object).forEach(([key, value]) => {\n    result[modify(key)] = modifyObjectKeys(value, modify);\n  });\n  return result;\n}\n\n/**\n * Performs a deep conversion to camelCase on all keys in the provided object and its tree of\n * children.  Uses [lodash.camelcase](https://lodash.com/docs/4.17.15#camelCase) on each key.  This\n * is commonly used to convert snake_case keys in models from a backend server into camelCase keys\n * for use in the JavaScript client.\n *\n * Can accept arrays as well as objects, and will perform its conversion on any objects it finds in\n * the array.\n *\n * @param {Array|Object} object\n * @returns {Array|Object}\n */\nexport function camelCaseObject(object) {\n  return modifyObjectKeys(object, camelCase);\n}\n\n/**\n * Performs a deep conversion to snake_case on all keys in the provided object and its tree of\n * children.  Uses [lodash.snakecase](https://lodash.com/docs/4.17.15#snakeCase) on each key.  This\n * is commonly used to convert camelCase keys from the JavaScript app into snake_case keys expected\n * by backend servers.\n *\n * Can accept arrays as well as objects, and will perform its conversion on any objects it finds in\n * the array.\n *\n * @param {Array|Object} object\n * @returns {Array|Object}\n */\nexport function snakeCaseObject(object) {\n  return modifyObjectKeys(object, snakeCase);\n}\n\n/**\n * Given a map of key-value pairs, performs a deep conversion key names in the specified object\n * _from_ the key _to_ the value.  This is useful for updating names in an API request to the names\n * used throughout a client application if they happen to differ.  It can also be used in the\n * reverse - formatting names from the client application to names expected by an API.\n *\n * ```\n * import { convertKeyNames } from '@edx/frontend-base';\n *\n * // This object can be of any shape or depth with subobjects/arrays.\n * const myObject = {\n *   myKey: 'my value',\n * }\n *\n * const result = convertKeyNames(myObject, { myKey: 'their_key' });\n *\n * console.log(result) // { their_key: 'my value' }\n * ```\n *\n * Can accept arrays as well as objects, and will perform its conversion on any objects it finds in\n * the array.\n *\n * @param {Array|Object} object\n * @param {Object} nameMap\n * @returns {Array|Object}\n */\nexport function convertKeyNames(object, nameMap) {\n  const transformer = key => (nameMap[key] === undefined ? key : nameMap[key]);\n\n  return modifyObjectKeys(object, transformer);\n}\n\n/**\n * *Deprecated*: A method which converts the supplied query string into an object of\n * key-value pairs and returns it.  Defaults to the current query string - should perform like\n * [window.searchParams](https://developer.mozilla.org/en-US/docs/Web/API/URL/searchParams)\n *\n * @deprecated\n * @param {string} [search=global.location.search]\n * @returns {Object}\n */\nexport function getQueryParameters(search = global.location.search) {\n  const keyValueFragments = search\n    .slice(search.indexOf('?') + 1)\n    .split('&')\n    .filter(hash => hash !== '');\n\n  return keyValueFragments.reduce((params, keyValueFragment) => {\n    const split = keyValueFragment.indexOf('=');\n    const key = keyValueFragment.slice(0, split);\n    const value = keyValueFragment.slice(split + 1);\n    return Object.assign(params, { [key]: decodeURIComponent(value) });\n  }, {});\n}\n\n/**\n * This function helps catch a certain class of misconfiguration in which configuration variables\n * are not properly defined and/or supplied to a consumer that requires them.  Any key that exists\n * is still set to \"undefined\" indicates a misconfiguration further up in the application, and\n * should be flagged as an error, and is logged to 'warn'.\n *\n * Keys that are intended to be falsy should be defined using null, 0, false, etc.\n *\n * @param {Object} object\n * @param {string} requester A human-readable identifier for the code which called this function.\n * Used when throwing errors to aid in debugging.\n */\nexport function ensureDefinedConfig(object, requester) {\n  Object.keys(object).forEach((key) => {\n    if (object[key] === undefined) {\n      // eslint-disable-next-line no-console\n      console.warn(`Module configuration error: ${key} is required by ${requester}.`);\n    }\n  });\n}\n\n/**\n * This function generates and returns the API config url based on the following environment variables:\n *\n *  MFE_CONFIG_API_PATH: API config path, this must not include the domain.\n *  MFE_CONFIG_API_PORT(Optional): Specify the port, useful in development environments\n *  MFE_CONFIG_API_REGEX: This regex will be used to generate the config domain based on the current domain.\n *  APP_ID(Optional): This value makes reference to specific settings for a MFE.\n *\n * @returns {string}\n */\nexport function generateAPIConfigUrl() {\n  const {\n    APP_ID,\n    MFE_CONFIG_API_PATH,\n    MFE_CONFIG_API_PORT,\n    MFE_CONFIG_API_REGEX,\n  } = getConfig();\n\n  if (!MFE_CONFIG_API_PATH || !MFE_CONFIG_API_REGEX) {\n    return null;\n  }\n\n  const regex = new RegExp(MFE_CONFIG_API_REGEX, 'g');\n  const host = (window.location.hostname.match(regex) || []).join('.');\n\n  if (!host) {\n    return null;\n  }\n\n  const params = new URLSearchParams();\n  params.append('mfe', APP_ID);\n  const queryParams = APP_ID ? `?${params.toString()}` : '';\n\n  const url = new URL(`${window.location.protocol}//${host}/${MFE_CONFIG_API_PATH}${queryParams}`);\n  url.port = MFE_CONFIG_API_PORT;\n\n  return url.toString();\n}\n"],"file":"utils.js"}