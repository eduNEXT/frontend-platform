{"version":3,"file":"AppProvider.js","names":["React","useState","useMemo","PropTypes","Router","OptionalReduxProvider","ErrorBoundary","AppContext","useAppEvent","useParagonTheme","getAuthenticatedUser","AUTHENTICATED_USER_CHANGED","getConfig","CONFIG_CHANGED","history","getLocale","getMessages","IntlProvider","LOCALE_CHANGED","AppProvider","store","children","config","setConfig","authenticatedUser","setAuthenticatedUser","locale","setLocale","paragonThemeState","paragonThemeDispatch","appContextValue","paragonTheme","state","dispatch","isThemeLoaded","propTypes","shape","node","isRequired","defaultProps"],"sources":["../../src/react/AppProvider.jsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { Router } from 'react-router-dom';\n\nimport OptionalReduxProvider from './OptionalReduxProvider';\n\nimport ErrorBoundary from './ErrorBoundary';\nimport AppContext from './AppContext';\nimport {\n  useAppEvent,\n  useParagonTheme,\n} from './hooks';\nimport { getAuthenticatedUser, AUTHENTICATED_USER_CHANGED } from '../auth';\nimport { getConfig } from '../config';\nimport { CONFIG_CHANGED } from '../constants';\nimport { history } from '../initialize';\nimport {\n  getLocale,\n  getMessages,\n  IntlProvider,\n  LOCALE_CHANGED,\n} from '../i18n';\n\n/**\n * A wrapper component for React-based micro-frontends to initialize a number of common data/\n * context providers.\n *\n * ```\n * subscribe(APP_READY, () => {\n *   ReactDOM.render(\n *     <AppProvider>\n *       <HelloWorld />\n *     </AppProvider>\n *   )\n * });\n * ```\n *\n * This will provide the following to HelloWorld:\n * - An error boundary as described above.\n * - An `AppContext` provider for React context data.\n * - IntlProvider for @edx/frontend-i18n internationalization\n * - Optionally a redux `Provider`. Will only be included if a `store` property is passed to\n * `AppProvider`.\n * - A `Router` for react-router.\n *\n * @param {Object} props\n * @param {Object} [props.store] A redux store.\n * @memberof module:React\n */\nexport default function AppProvider({ store, children }) {\n  const [config, setConfig] = useState(getConfig());\n  const [authenticatedUser, setAuthenticatedUser] = useState(getAuthenticatedUser());\n  const [locale, setLocale] = useState(getLocale());\n\n  useAppEvent(AUTHENTICATED_USER_CHANGED, () => {\n    setAuthenticatedUser(getAuthenticatedUser());\n  });\n\n  useAppEvent(CONFIG_CHANGED, () => {\n    setConfig(getConfig());\n  });\n\n  useAppEvent(LOCALE_CHANGED, () => {\n    setLocale(getLocale());\n  });\n\n  const [paragonThemeState, paragonThemeDispatch] = useParagonTheme(config);\n\n  const appContextValue = useMemo(() => ({\n    authenticatedUser,\n    config,\n    locale,\n    paragonTheme: {\n      state: paragonThemeState,\n      dispatch: paragonThemeDispatch,\n    },\n  }), [authenticatedUser, config, locale, paragonThemeState, paragonThemeDispatch]);\n\n  if (!paragonThemeState?.isThemeLoaded) {\n    return null;\n  }\n\n  return (\n    <IntlProvider locale={locale} messages={getMessages()}>\n      <ErrorBoundary>\n        <AppContext.Provider\n          value={appContextValue}\n        >\n          <OptionalReduxProvider store={store}>\n            <Router history={history}>\n              {children}\n            </Router>\n          </OptionalReduxProvider>\n        </AppContext.Provider>\n      </ErrorBoundary>\n    </IntlProvider>\n  );\n}\n\nAppProvider.propTypes = {\n  store: PropTypes.shape({}),\n  children: PropTypes.node.isRequired,\n};\n\nAppProvider.defaultProps = {\n  store: null,\n};\n"],"mappings":";;;;;;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,OAAO,QAAQ,OAAO;AAChD,OAAOC,SAAS,MAAM,YAAY;AAClC,SAASC,MAAM,QAAQ,kBAAkB;AAEzC,OAAOC,qBAAqB,MAAM,yBAAyB;AAE3D,OAAOC,aAAa,MAAM,iBAAiB;AAC3C,OAAOC,UAAU,MAAM,cAAc;AACrC,SACEC,WAAW,EACXC,eAAe,QACV,SAAS;AAChB,SAASC,oBAAoB,EAAEC,0BAA0B,QAAQ,SAAS;AAC1E,SAASC,SAAS,QAAQ,WAAW;AACrC,SAASC,cAAc,QAAQ,cAAc;AAC7C,SAASC,OAAO,QAAQ,eAAe;AACvC,SACEC,SAAS,EACTC,WAAW,EACXC,YAAY,EACZC,cAAc,QACT,SAAS;;AAEhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,WAAW,OAAsB;EAAA,IAAnBC,KAAK,QAALA,KAAK;IAAEC,QAAQ,QAARA,QAAQ;EACnD,gBAA4BpB,QAAQ,CAACW,SAAS,EAAE,CAAC;IAAA;IAA1CU,MAAM;IAAEC,SAAS;EACxB,iBAAkDtB,QAAQ,CAACS,oBAAoB,EAAE,CAAC;IAAA;IAA3Ec,iBAAiB;IAAEC,oBAAoB;EAC9C,iBAA4BxB,QAAQ,CAACc,SAAS,EAAE,CAAC;IAAA;IAA1CW,MAAM;IAAEC,SAAS;EAExBnB,WAAW,CAACG,0BAA0B,EAAE,YAAM;IAC5Cc,oBAAoB,CAACf,oBAAoB,EAAE,CAAC;EAC9C,CAAC,CAAC;EAEFF,WAAW,CAACK,cAAc,EAAE,YAAM;IAChCU,SAAS,CAACX,SAAS,EAAE,CAAC;EACxB,CAAC,CAAC;EAEFJ,WAAW,CAACU,cAAc,EAAE,YAAM;IAChCS,SAAS,CAACZ,SAAS,EAAE,CAAC;EACxB,CAAC,CAAC;EAEF,uBAAkDN,eAAe,CAACa,MAAM,CAAC;IAAA;IAAlEM,iBAAiB;IAAEC,oBAAoB;EAE9C,IAAMC,eAAe,GAAG5B,OAAO,CAAC;IAAA,OAAO;MACrCsB,iBAAiB,EAAjBA,iBAAiB;MACjBF,MAAM,EAANA,MAAM;MACNI,MAAM,EAANA,MAAM;MACNK,YAAY,EAAE;QACZC,KAAK,EAAEJ,iBAAiB;QACxBK,QAAQ,EAAEJ;MACZ;IACF,CAAC;EAAA,CAAC,EAAE,CAACL,iBAAiB,EAAEF,MAAM,EAAEI,MAAM,EAAEE,iBAAiB,EAAEC,oBAAoB,CAAC,CAAC;EAEjF,IAAI,EAACD,iBAAiB,aAAjBA,iBAAiB,eAAjBA,iBAAiB,CAAEM,aAAa,GAAE;IACrC,OAAO,IAAI;EACb;EAEA,oBACE,oBAAC,YAAY;IAAC,MAAM,EAAER,MAAO;IAAC,QAAQ,EAAEV,WAAW;EAAG,gBACpD,oBAAC,aAAa,qBACZ,oBAAC,UAAU,CAAC,QAAQ;IAClB,KAAK,EAAEc;EAAgB,gBAEvB,oBAAC,qBAAqB;IAAC,KAAK,EAAEV;EAAM,gBAClC,oBAAC,MAAM;IAAC,OAAO,EAAEN;EAAQ,GACtBO,QAAQ,CACF,CACa,CACJ,CACR,CACH;AAEnB;AAEAF,WAAW,CAACgB,SAAS,GAAG;EACtBf,KAAK,EAAEjB,SAAS,CAACiC,KAAK,CAAC,CAAC,CAAC,CAAC;EAC1Bf,QAAQ,EAAElB,SAAS,CAACkC,IAAI,CAACC;AAC3B,CAAC;AAEDnB,WAAW,CAACoB,YAAY,GAAG;EACzBnB,KAAK,EAAE;AACT,CAAC"}