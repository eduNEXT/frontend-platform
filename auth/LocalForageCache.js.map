{"version":3,"file":"LocalForageCache.js","names":["localforage","memoryDriver","setupCache","defaultKeyGenerator","defaultHeaderInterpreter","buildStorage","axios","configureCache","defineDriver","forageStore","createInstance","driver","INDEXEDDB","LOCALSTORAGE","_driver","name","forageStoreAdapter","find","key","getItem","result","JSON","parse","set","value","setItem","stringify","remove","removeItem","create","ttl","storage","generateKey","headerInterpreter","debug","console","log"],"sources":["../../src/auth/LocalForageCache.js"],"sourcesContent":["/* eslint-disable no-underscore-dangle */\nimport localforage from 'localforage';\nimport memoryDriver from 'localforage-memoryStorageDriver';\nimport {\n  setupCache,\n  defaultKeyGenerator,\n  defaultHeaderInterpreter,\n  buildStorage,\n} from 'axios-cache-interceptor';\nimport axios from 'axios';\n\n/**\n * Async function to configure localforage and setup the cache\n *\n * @returns {Promise} A promise that, when resolved, returns an axios instance configured to\n * use localforage as a cache.\n */\nexport default async function configureCache() {\n  // Register the imported `memoryDriver` to `localforage`\n  await localforage.defineDriver(memoryDriver);\n\n  // Create `localforage` instance\n  const forageStore = localforage.createInstance({\n    // List of drivers used\n    driver: [\n      localforage.INDEXEDDB,\n      localforage.LOCALSTORAGE,\n      memoryDriver._driver,\n    ],\n    name: 'edx-cache',\n  });\n\n  const forageStoreAdapter = buildStorage({\n    async find(key) {\n      const result = await forageStore.getItem(`axios-cache:${key}`);\n      return JSON.parse(result);\n    },\n\n    async set(key, value) {\n      await forageStore.setItem(`axios-cache:${key}`, JSON.stringify(value));\n    },\n\n    async remove(key) {\n      await forageStore.removeItem(`axios-cache:${key}`);\n    },\n  });\n\n  // only GET methods are cached by default\n  return setupCache(\n    // axios instance\n    axios.create(),\n    {\n      ttl: 5 * 60 * 1000, // default maxAge of 5 minutes\n      // The storage to save the cache data. There are more available by default.\n      //\n      // https://axios-cache-interceptor.js.org/#/pages/storages\n      storage: forageStoreAdapter,\n\n      // The mechanism to generate a unique key for each request.\n      //\n      // https://axios-cache-interceptor.js.org/#/pages/request-id\n      generateKey: defaultKeyGenerator,\n\n      // The mechanism to interpret headers (when cache.interpretHeader is true).\n      //\n      // https://axios-cache-interceptor.js.org/#/pages/global-configuration?id=headerinterpreter\n      headerInterpreter: defaultHeaderInterpreter,\n\n      // The function that will receive debug information.\n      // NOTE: For this to work, you need to enable development mode.\n      //\n      // https://axios-cache-interceptor.js.org/#/pages/development-mode\n      // https://axios-cache-interceptor.js.org/#/pages/global-configuration?id=debug\n      // eslint-disable-next-line no-console\n      debug: console.log,\n    },\n  );\n}\n"],"mappings":";+CACA;AAAA;AAAA;AADA;AACA,OAAOA,WAAW,MAAM,aAAa;AACrC,OAAOC,YAAY,MAAM,iCAAiC;AAC1D,SACEC,UAAU,EACVC,mBAAmB,EACnBC,wBAAwB,EACxBC,YAAY,QACP,yBAAyB;AAChC,OAAOC,KAAK,MAAM,OAAO;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA,wBAA8BC,cAAc;EAAA;AAAA;AA4D3C;EAAA,6EA5Dc;IAAA;IAAA;MAAA;QAAA;UAAA;UAAA,OAEPP,WAAW,CAACQ,YAAY,CAACP,YAAY,CAAC;QAAA;UAE5C;UACMQ,WAAW,GAAGT,WAAW,CAACU,cAAc,CAAC;YAC7C;YACAC,MAAM,EAAE,CACNX,WAAW,CAACY,SAAS,EACrBZ,WAAW,CAACa,YAAY,EACxBZ,YAAY,CAACa,OAAO,CACrB;YACDC,IAAI,EAAE;UACR,CAAC,CAAC;UAEIC,kBAAkB,GAAGX,YAAY,CAAC;YAChCY,IAAI,gBAACC,GAAG,EAAE;cAAA;gBAAA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACOT,WAAW,CAACU,OAAO,uBAAgBD,GAAG,EAAG;oBAAA;sBAAxDE,MAAM;sBAAA,iCACLC,IAAI,CAACC,KAAK,CAACF,MAAM,CAAC;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA;YAC3B,CAAC;YAEKG,GAAG,eAACL,GAAG,EAAEM,KAAK,EAAE;cAAA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACdf,WAAW,CAACgB,OAAO,uBAAgBP,GAAG,GAAIG,IAAI,CAACK,SAAS,CAACF,KAAK,CAAC,CAAC;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA;YACxE,CAAC;YAEKG,MAAM,kBAACT,GAAG,EAAE;cAAA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACVT,WAAW,CAACmB,UAAU,uBAAgBV,GAAG,EAAG;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA;YACpD;UACF,CAAC,CAAC,EAEF;UAAA,kCACOhB,UAAU;UACf;UACAI,KAAK,CAACuB,MAAM,EAAE,EACd;YACEC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI;YAAE;YACpB;YACA;YACA;YACAC,OAAO,EAAEf,kBAAkB;YAE3B;YACA;YACA;YACAgB,WAAW,EAAE7B,mBAAmB;YAEhC;YACA;YACA;YACA8B,iBAAiB,EAAE7B,wBAAwB;YAE3C;YACA;YACA;YACA;YACA;YACA;YACA8B,KAAK,EAAEC,OAAO,CAACC;UACjB,CAAC,CACF;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA,CACF;EAAA;AAAA"}